# Wealth Tracker Project

## Quick Reference

### Project Structure
- `backend/` - Django REST API
- `frontend/` - React/TypeScript frontend
- `venv/` - Python virtual environment

### Running the Project
```bash
# Backend
cd backend && source ../venv/bin/activate && python manage.py runserver

# Frontend
cd frontend && npm run dev
```

### Key Documentation
- **Morgan Stanley Integration**: See [docs/morgan-stanley-integration.md](docs/morgan-stanley-integration.md)
  - CRITICAL: `employeeid` header uses `employeePK` (NOT JWT `sub` claim!)
  - JWT tokens expire in ~1 hour

## Broker Integrations

### Morgan Stanley at Work
- Uses GraphQL API at `https://atwork.morganstanley.com/graphql`
- Requires: JWT token + employee_id (from `employeePK`, not JWT sub!)
- Bot detection may block login - use DevTools to get JWT manually
- See full docs: [docs/morgan-stanley-integration.md](docs/morgan-stanley-integration.md)

### Interactive Brokers (IBKR)
- Uses Flex Web Service API
- Requires: `flex_token` + `query_id` from Client Portal

### TrueWealth
- Swiss robo-advisor
- Requires: username + password + TOTP secret

### VIAC
- Swiss 3a retirement platform
- Requires: username + password

## Common Issues & Solutions

### Morgan Stanley 500 Error on GraphQL
**Problem**: Using JWT `sub` claim as `employeeid` header
**Solution**: Use `employeePK` from dashboard HTML (`SW.initialData.activeAccount.employeePK`)

### Morgan Stanley JWT Extraction
JWT is generated by frontend JS, not in login response. Extract from:
- DevTools > Network > filter 'graphql' > Request Headers > 'authorization'
